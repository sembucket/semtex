Synopsis
--------

This version of semtex is specialised for linearised steady and
Floquet stability analysis, which implies a number of restrictions not
present in the basic semtex package.  The stability analysis solver
derives from the Barkley/Henderson floK code [1], see also [3] and [4]
for a description of the numerical techniques. 

Copyright (c) 1999 <--> $Date$, Hugh Blackburn.

There are two codes here: lns and arnoldi. Lns is equivalent to
semtex/dns: it evolves the linearised Navier--Stokes equations.
Arnoldi is the actual analysis code, which carries out eigensolution
of the stability problem.  The time integration routines required to
evolve the linearised Navier--Stokes equations are identical for the
two codes.  One might use lns to evolve an initially random
perturbation to an exponential growth or decay phase, then apply
arnoldi to estimate the leading Ritz eigenvalues and vectors of the
flow. Both codes are designed for serial execution only.

Arnoldi-H is a variant of arnoldi that can (but does not have to) be
applied if the base flow has a reflection in space, translation in
time symmetry, see [5].  In this case, the code flipmap must be used
to create a pair of mapping vectors from the session mesh file.  The
integration period declared in the session file must be half that of
the base flow.

The session file referred to below relates to the perturbation
velocity field: the session file for the base flow is naturally
assumed to supply the same 2D geometric information, but is not
directly referred to.

Description
-----------

The "base flow", or velocity field, for which the stability analysis
is performed, is always taken to be two-dimensional, but can have two
or three active velocity components, and can be either steady or
periodic in time (for Floquet analysis).  The number of velocity
components of the base flow is declared in the session file by the
token N_BASE.  Legal values are 2 and 3.  Temporal variation of the
base flow is declared by the token N_SLICE.  Legal values are either
1, or a number that has prime factors of 2, 3, and/or 5.  Values
greater than 1 signal that the base flow is periodic in time, and the
base flow field file should have the same number of dumps in it (this
is checked at run-time); these are read into memory and used as the
basis of Fourier reconstruction of the velocity field at any point in
time.

The "perturbation field" can be regarded as a Fourier mode, and dealt
with always in Fourier-transformed space. It is possible for the
perturbation field to be two-component and two-dimensional, otherwise
it is three-component (and two- or three-dimensional).  If the base
flow is two-component (i.e. U & V only), and the perturbation is
three-component, there exists a special decomposition of the
perturbation field into two decoupled parts, and often it suffices to
study the behaviour of one of the parts only (only if the eigenvalues
are pure real).  Under this decomposition the u, v, velocity fields
and the pressure are taken to be represented by the real part of a
Fourier mode, and the w velocity by the imaginary part.  In this case
("half-complex"), the number of planes in the mode, _nz is 1.  If the
base flow is three-component (but still two-dimensional), then the
decoupling does not occur, and the perturbation field is fully complex
and three-component. See [4], [6], [7] for more information.

Since the base flow period is estimated from information in
session.bse, it is sensible to reset the Time in the generating
restart file to 0.0, in order to minimise subsequent rounding errors
in calculating the period of the base flow.

NB: remember to revise the session file BCs (and possibly session.num)
before use for stability analysis.

Summary of number of velocity components
----------------------------------------

N_BASE  N_PERT  N_Z    COMPLEXITY
 2       2       1     Real only:     u.Re v.Re      p.Re
 2       3       1     Half-complex:  u.Re v.Re w.Im p.Re
 2       3       2     Full-complex
 3       2       1     NA
 3       3       1     Real only:     u.Re v.Re w.Re p.Re
 3       3       2     Full-complex


OR, categorizing by symmetries of base flow and dimensionality and
symmetry of perturbation (and cases that have been checked):

N_BASE  N_PERT  N_Z    CATEGORY         CARTESIAN     CYLINDRICAL
 2       2       1      O(2)/2D		 OK            OK
 2       3       1      O(2)/3D/SYM	 OK            OK
 2       3       2      O(2)/3D		 OK            OK
 3       2       1                       --     NA     --
 3       3       1      SO(2)/2D	 ??            ??
 3       3       2      SO(2)/3D	 ??            OK

(?? cases most likely are OK.)

Note that N_PERT >= N_BASE always.

Summary of additional TOKENS and session file requirements
----------------------------------------------------------

N_BASE:  number of velocity components in base flow (2 or 3)
N_SLICE: number of time slices in session.bse (1 for steady base flow)

N_PERT is set according to the number of velocity fields nominated in
the session file (i.e. <FIELDS NUMBER=npert+1>).

Files
-----

In addition to standard semtex files (session, session.num,
session.rst), a file containing the base flow (session.bse) is also
required.  An additional information file called session.run,
containing the machine name and run pid, is also produced. For
arnoldi-H, the file session.map (produced by the flipmap utility) is
needed as well.

References
----------
[1]  D Barkley & RD Henderson (1996), "Three-dimensional Floquet
     stability analysis of the wake of a circular cylinder",
     J Fluid Mech V322, 215--241.
[2]  Y Saad (1991), "Numerical methods for large eigenvalue problems"
     Wiley.
[3]  LS Tuckerman & D Barkley (2000), "Bifurcation analysis for
     timesteppers", in Numerical Methods for Bifurcation Problems,
     eds E Doedel & LS Tuckerman, Springer. 453--466.
[4]  HM Blackburn (2002), "Three-dimensional instability and state
     selection in an oscillatory axisymmetric swirling flow",
     Phys Fluids V14(11), 3983--3996.
[5]  F Marques, JM Lopez & HM Blackburn (2004), "Bifurcations in
     systems with Z2 spatio-temporal and O(2) spatial symmetry",
     Physica D, V189, 247--276.
[6]  HM Blackburn & JM Lopez (2003), "On three-dimensional quasiperiodic
     Floquet instabilities of two-dimensional bluff body wakes",
     Phys Fluids V15(8), L57-60.
[7]  HM Blackburn & JM Lopez (2003), "The onset of three-dimensional
     standing and modulated travelling waves in a periodically driven
     cavity flow", J Fluid Mech V497, 289--317.

$Id$
