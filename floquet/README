Synopsis
--------

This version of semtex is specialised for linearised steady and
Floquet stability analysis, which implies a number of restrictions not
present in the basic semtex package.  The stability analysis solver
derives from the Barkley/Henderson floK code.  All serial code.

Copyright (C) 1999, 2002 Hugh Blackburn.

There are two codes here: lns and arnoldi. Lns is equivalent to
semtex/dns: it evolves the linearised Navier--Stokes equations.
Arnoldi is the actual analysis code, which carries out eigensolution
of the stability problem.  The time integration routines required to
evolve the linearised Navier--Stokes equations are identical for the
two codes.  Typically one might use lns to evolve an initially random
perturbation to an exponential growth or decay phase, then apply
arnoldi to estimate the leading Ritz eigenvalues and vectors of the
flow.

Arnoldi-RT is a variant of arnoldi that can (but does not have to) be
applied if the base flow has a reflection in space, translation in
time (RT) symmetry.  In this case, the code flipmap must be used to
create a pair of mapping vectors from the session mesh file.  The
integration period declared in the session file must be half that of
the base flow.

The session file referred to below relates to
the perturbation velocity field: the session file for the base flow is
naturally assumed to supply the same 2D geometric information, but is
not directly referred to.

Description
-----------

The "base flow", or velocity field, for which the stability analysis
is performed, is always taken to be two-dimensional, but can have two
or three active velocity components, and can be either steady or
periodic in time (for Floquet analysis).  The number of velocity
components of the base flow is declared in the session file by the
token N_BASE.  Legal values are 2 and 3.  Temporal variation of the
base flow is declared by the token N_SLICE.  Legal values are either
1, or a number that has prime factors of 2, 3, and/or 5.  Values
greater than 1 signal that the base flow is periodic in time, and the
base flow field file should have the same number of dumps in it (this
is checked at run-time); these are read into memory and used as the
basis of Fourier reconstruction of the velocity field at any point in
time.

The "perturbation field" can be regarded as a Fourier mode, and dealt
with always in Fourier-transformed space. It is possible for the
perturbation field to be two-component and two-dimensional, otherwise
it is three-component (and two- or three-dimensional).  If the base
flow is two-component (i.e. U & V only), and the perturbation is
three-component, there exists a special decomposition of the
perturbation field into two decoupled parts, and it suffices to study
the behaviour of one of the parts only.  Under this decomposition the
u, v, velocity fields and the pressure are taken to be represented by
the real part of a Fourier mode, and the w velocity by the imaginary
part.  In this case ("half-complex"), the number of planes in the
mode, _nz is 1.  If the base flow is three-component (but still
two-dimensional), then the decoupling does not occur, and the
perturbation field is fully complex and three-component.

Since the base flow period is estimated from information in
session.bse, it is sensible to reset the Time in the generating
restart file to 0.0, in order to minimise subsequent rounding errors
in calculating the period of the base flow.

NB: remember to revise the session file BCs (and possibly session.num)
before use for stability analysis.

Summary of number of velocity components
----------------------------------------

N_BASE  N_PERT  N_Z    COMPLEXITY
 2       2       1     Real only:     u.Re v.Re      p.Re
 2       3       1     Half-complex:  u.Re v.Re w.Im p.Re
 2       3       2     Full-complex:
 3       2       1     N/A
 3       3       1     Real only
 3       3       2     Full-complex


OR, categorizing by symmetries of base flow and dimensionality and
symmetry of perturbation:

N_BASE  N_PERT  N_Z    CATEGORY
 2       2       1     O(2)/2D		Working
 2       3       1     O(2)/3D/SYM	Working / being fixed (call!)
 2       3       2     O(2)/3D		Under construction
 3       2       1     SO(2)/2D		Impossible (?)
 3       3       1     SO(2)/2D		Maybe one day
 3       3       2     SO(2)/3D		Working

Summary of additional TOKENS and session file requirements
----------------------------------------------------------

N_BASE:  number of velocity components (2 or 3)
N_SLICE: number of time slices in session.bse (1 for steady base flow)

N_PERT is set according to the number of velocity fields nominated in
the session file (i.e. <FIELDS NUMBER=npert+1>).

Files
-----

In addition to standard semtex files (session, session.num,
session.rst), a file containing the base flow (session.bse) is also
required.  An additional information file called session.run,
containing the machine name and run pid, is also produced.

References
----------
[1]  D. Barkley & R.D. Henderson (1996), "Three-dimensional Floquet
     stability analysis of the wake of a circular cylinder",
     J. Fluid Mech V322, 215--241.
[2]  Y. Saad (1991), "Numerical methods for large eigenvalue problems"
     Wiley.
[3]  L.S. Tuckerman & D. Barkley (2000), "Bifurcation analysis for
     timesteppers", in Numerical Methods for Bifurcation Problems,
     ed E. Doedel & L.S. Tuckerman, Springer. 453--466.

$Id$
