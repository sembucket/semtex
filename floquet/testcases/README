$Id$

ARNOLDI TESTCASES
=================

The testcases in various subdirectories here exercise various
different parts the stability analysis code arnoldi. For cases with
steady base flows, the full base flow file is provided, while for
cases with time-periodic base flows, a restart file is provided with
which to regenerate the base flow. Shell scripts are/will be provided
for re-running the test cases.

STEADY FLOWS
============

chan2D 
------

Steady 2D Poiseuille channel flow at Re=7500 is 2D unstable to (2D)
TS waves.  This case is documented in Canuto et al., 1988,
p19--25. The base flow is steady and 2C/2D; the perturbation is
unsteady and 2C/2D also.

These are the results of running

arnoldi -k 16 -n 1 -m 500 -t 1e-6 chan3

-- Iteration = 260, H(k+1, k) = 0.893587
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  1.0022e+00  2.4989e-01  2.2356e-03  2.4989e-01  9.4531e-07
 1  1.0022e+00 -2.4989e-01  2.2356e-03 -2.4989e-01  9.4531e-07

The corresponding case in Canuto et al. suggests 2.23497e-3 and
2.4989154e-1 for Growth and Frequency parameters respectively.

swirl2D
-------

The steady flow in a lid-driven cavity has a number of axisymmetric
modes, as described in

Lopez, Marques & Sanchez (2001), Oscillatory modes in an enclosed
swirling flow, JFM 439: 109-129.

At Re=4000, the period of the leading mode is predicted by Lopez et al
to be (page 16) 4000*0.007175=28.3.

Here is the result of running

arnoldi -k 8 -n 1 -m 200 vb2

-- Iteration = 124, H(k+1, k) = 0.682631
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  1.1831e+00  3.0637e+00  1.2178e-02  2.2185e-01  8.5612e-07
 1  1.1831e+00 -3.0637e+00  1.2178e-02 -2.2185e-01  8.5612e-07
 2  1.1244e+00  1.6671e+00  8.4919e-03  1.2072e-01  3.8997e-05
 3  1.1244e+00 -1.6671e+00  8.4919e-03 -1.2072e-01  3.8997e-05
 4  1.0890e+00  2.5309e+00  6.1746e-03  1.8327e-01  2.3270e-03
 5  1.0890e+00 -2.5309e+00  6.1746e-03 -1.8327e-01  2.3270e-03
 6  9.4068e-01  1.7243e+00 -4.4283e-03  1.2486e-01  4.4281e-01
 7  9.4068e-01 -1.7243e+00 -4.4283e-03 -1.2486e-01  4.4281e-01
arnoldi: converged, writing 1 eigenvectors.

The period of the leading mode is TWOPI/0.22185=23.322.

backstep3D
----------

Steady 2D backward-facing step flow (2C/2D) is first unstable with
increasing Re to a steady 3C/3D instability. 

Barkley, Gomes & Henderson (2002), Three-dimensional instability in
flow over a backward-facing step, JFM 473: 167-190.

At a Re=750 the neutrally stable eigenvalue is real; here are the
results of running

arnoldi -k 25 -n 1 -m 500 -t 1e-6 back

-- Iteration = 330, H(k+1, k) = 0.981132
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  1.0009e+00  0.0000e+00  4.2604e-04  0.0000e+00  9.9141e-07
 1  9.7469e-01  0.0000e+00 -1.2817e-02  0.0000e+00  4.8710e-04
 2  9.7237e-01  6.4095e-02 -1.4011e-02  3.2047e-02  6.4013e-04
 3  9.7237e-01 -6.4095e-02 -1.4011e-02 -3.2047e-02  6.4013e-04
 4  8.9804e-01  9.5132e-01 -5.3771e-02  4.7566e-01  3.5549e-03


stenosis3D
----------

Steady axisymmetric flow in a cylindrical stenosis has a (nearly)
unstable 3D mode, k = 1.

These are the results of running

arnoldi -k 8 -n 1 -m 100 -t 1e-8 Sten50_Cyl

-- Iteration = 72, H(k+1, k) = 0.393738
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  9.7378e-01  0.0000e+00 -5.3146e-02  0.0000e+00  5.1712e-09
 1  7.6398e-01  1.6488e-01 -5.3843e-01  3.2976e-01  5.8660e-04
 2  7.6398e-01 -1.6488e-01 -5.3843e-01 -3.2976e-01  5.8660e-04
 3  5.0688e-01  6.3945e-01 -1.3590e+00  1.2789e+00  2.7477e-02
 4  5.0688e-01 -6.3945e-01 -1.3590e+00 -1.2789e+00  2.7477e-02
 5  7.2626e-01  1.7028e+00 -6.3968e-01  3.4056e+00  5.1288e-02
 6  7.2626e-01 -1.7028e+00 -6.3968e-01 -3.4056e+00  5.1288e-02
 7  4.1267e-01  0.0000e+00 -1.7702e+00  0.0000e+00  8.3558e-02
arnoldi: converged, writing 1 eigenvectors.


PERIODIC FLOWS
==============

cylinder3D
----------

The circular cylinder at Re=220 has a 2C/2D time-periodic wake that is
unstable to a 3C/3D synchronous "mode A" instability.

Barkley & Henderson (1996), Three-dimensional Floquet stability
analysis of the wake of a circular cylinder, JFM 322: 215-241.

These are the results (after 16 cycles) of running

arnoldi -k 12 -n 1 -m 40 -t 1e-6 m32

-- Iteration = 16, H(k+1, k) = 0.604031
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  1.2670e+00  0.0000e+00  4.7694e-02  0.0000e+00  2.1693e-03
 1  2.4149e-01  0.0000e+00 -2.8637e-01  0.0000e+00  9.5971e-02
 2  3.8874e-01  1.3107e+00 -1.9042e-01  2.6415e-01  1.3109e-01

The residual actually fails to get much lower for this analysis.


cavityTW
--------

The 2:1 rectangular driven cavity is a 2C/2D time-periodic flow that
at St=100, Re=1212 has quasi-periodic 3C/3D SW/TW instabilities.

Blackburn & Lopez (2003), The onset of three-dimensional standing
and modulated travelling waves in a periodically driven cavity flow,
JFM 497.

These are the results of running (for N_Z=1 or 2)

arnoldi -k 13 -m 40 -n 2 -t 1e-6 cav01

-- Iteration = 14, H(k+1, k) = 0.0653317
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  9.9854e-01  1.5277e+00 -1.2044e-04  1.2605e-01  1.9949e-07
 1  9.9854e-01 -1.5277e+00 -1.2044e-04 -1.2605e-01  1.9949e-07
 2  9.3304e-01  1.3784e+00 -5.7183e-03  1.1373e-01  2.1672e-07
 3  9.3304e-01 -1.3784e+00 -5.7183e-03 -1.1373e-01  2.1672e-07

(In this case, the second mode has the lower residual for quite a
number of iterations.)

swirl3D
-------

The 2:1 cylindrical driven cavity at Re=4000 is an axisymmetric 3C/2D
time-periodic flow that has 3C/3D MRW instabilities.

Blackburn (2002), Three-dimensional instability and state selection in
an oscillatory axisymmetric swirling flow, Phys. Fluids V14N11:
3983-96.

These are the results of running

arnoldi -k 13 -m 40 -n 1 -t 1e-6 vb2

-- Iteration = 12, H(k+1, k) = 0.224362
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  1.4650e+00  2.3637e+00  1.3503e-02  8.3576e-02  2.2579e-07
 1  1.4650e+00 -2.3637e+00  1.3503e-02 -8.3576e-02  2.2579e-07
 2  6.1877e-01  1.0471e+00 -1.6973e-02  3.7024e-02  8.6123e-04
 3  6.1877e-01 -1.0471e+00 -1.6973e-02 -3.7024e-02  8.6123e-04
 4  2.1469e-01  1.8772e+00 -5.4401e-02  6.6375e-02  3.1454e-02
 5  2.1469e-01 -1.8772e+00 -5.4401e-02 -6.6375e-02  3.1454e-02
 6  2.8306e-01  2.9088e+00 -4.4626e-02  1.0285e-01  6.0795e-02
 7  2.8306e-01 -2.9088e+00 -4.4626e-02 -1.0285e-01  6.0795e-02
 8  3.1172e-01  3.2734e-01 -4.1215e-02  1.1574e-02  6.2372e-02
 9  3.1172e-01 -3.2734e-01 -4.1215e-02 -1.1574e-02  6.2372e-02
10  1.1103e-01  0.0000e+00 -7.7715e-02  0.0000e+00  1.0460e-01
11  1.3551e-01  3.1416e+00 -7.0670e-02  1.1108e-01  1.5836e-01
arnoldi: converged, writing 1 eigenvectors.

TRANSIENT GROWTH
================

pulseChan
---------

This is transient growth in 2D pulsatile channel flow. 
The analytical solution for the base flow is given by

@Article{straatman02,
  author = {A. G. Straatman and R. E. Khayat and E. Haj-Qasem
            and D. A. Steinman},
  title = {On the hydrodynamic stability of pulsatile flow in a plane
           channel},
  journal = {Physics of Fluids},
  volume = 14,
  pages = {1938--1944},
  year = 2002
}

Running

../../arnoldi -g -k 4 -n 1 -m 50 -t 1e-6 chan3 > /dev/null

converges to 

-- Iteration = 6, H(k+1, k) = 0.012683
EV  Magnitude   Angle       Growth      Frequency   Residual
 0  5.3788e-01  0.0000e+00 -4.9348e-02  0.0000e+00  2.7288e-07
 1  8.4661e-02  0.0000e+00 -1.9649e-01  0.0000e+00  2.5166e-03
 2  6.4262e-02  0.0000e+00 -2.1842e-01  0.0000e+00  5.8113e-03
 3  3.4631e-02  0.0000e+00 -2.6762e-01  0.0000e+00  1.1108e-02
arnoldi: converged, writing 1 eigenvectors.

One can check the result by restarting lns using chan3.eig.0 as a
restart file, then looking at the energies in the starting and final
condtion, using moden and integral:

[avia pulseChan]$ moden chan3.rst | integral chan3
12.566371
q: 0.0014471185 , centroid: -0.0002869032 , -0.015883868
[avia pulseChan]$ moden chan3.fld | integral chan3
12.566371
q: 0.00077780029 , centroid: -4.2811406e-06 , -0.0062704707
[avia pulseChan]$ calc
0.00077780029/0.0014471185
0.5374820997727553


